# Git トラブルシューティングガイド

## コミットを元に戻す方法

### 直前のコミットを取り消す
```bash
# 直前のコミットを取り消し、変更を残したまま
git reset --soft HEAD^

# 直前のコミットを完全に取り消し、変更も削除
git reset --hard HEAD^
```

### 特定のファイルを前のバージョンに戻す
```bash
# 特定のファイルを直前のコミットの状態に戻す
git checkout HEAD^ [ファイル名]

# 特定のファイルを指定したコミットハッシュの状態に戻す
git checkout [コミットハッシュ] [ファイル名]
```

## コンフリクトの解決方法

### mainブランチとのコンフリクト解決
1. まずmainブランチを最新に更新
```bash
git checkout main
git pull origin main
```

2. 作業ブランチに戻ってmainをマージ
```bash
git checkout [作業ブランチ名]
git merge main
```

3. コンフリクトが発生したファイルを修正
4. 修正後、ファイルを追加してコミット
```bash
git add [コンフリクトを解決したファイル]
git commit -m "Resolve conflicts with main"
```

## コミット履歴の整理（リベース）

### リベースを使用できる場合と注意点
- **リベース可能な場合**：
  - ローカルの変更をまだpushしていない場合
  - 個人で使用している作業ブランチの場合
  
- **リベース禁止の場合**：
  - すでにpush済みの共有ブランチ
  - 他の開発者と共有しているブランチ

### コミットを整理する方法
```bash
# 直近の3つのコミットを整理する場合
git rebase -i HEAD~3

# mainブランチを基準にリベース
git rebase main
```

### リベース中のコマンド
- `pick`: コミットをそのまま使用
- `squash`: 前のコミットと統合
- `fixup`: コミットメッセージを破棄して統合
- `drop`: コミットを削除

### トラブル時の対処
リベース中に問題が発生した場合：
```bash
# リベースを中止して元の状態に戻る
git rebase --abort
```

## 一般的なトラブル対処のTips

1. 作業内容を一時退避したい場合
```bash
# 変更を一時保存
git stash

# 保存した変更を戻す
git stash pop
```

2. 誤って削除したブランチを復元
```bash
# 削除したブランチの一覧を確認
git reflog

# ブランチを復元
git checkout -b [ブランチ名] [コミットハッシュ]
```

3. コミットメッセージを修正
```bash
# 直前のコミットメッセージを修正
git commit --amend
```
